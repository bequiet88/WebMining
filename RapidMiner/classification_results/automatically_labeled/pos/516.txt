Substitute Edin Dzeko scored two late goals to earn 10-man Manchester City an unlikely win against West Brom.